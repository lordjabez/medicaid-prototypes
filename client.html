<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Medicaid Application — Medical Frailty</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">&larr; Back to prototype home</a>

    <div class="card">
      <div class="brand">Pennsylvania DHS — Medicaid Application</div>

      <!-- Progress bar -->
      <div class="progress-bar">
        <div class="progress-dot active" id="dot-1"></div>
        <div class="progress-dot" id="dot-2"></div>
        <div class="progress-dot" id="dot-3"></div>
        <div class="progress-dot" id="dot-4"></div>
      </div>

      <!-- Screen 1: Medical condition question -->
      <div class="screen active" id="screen-1">
        <h2>Medical Condition</h2>
        <p class="question">Do you have a medical condition that prevents you from working at least 80 hours a month?</p>
        <p><a href="https://www.pa.gov/agencies/dhs/resources/federal-cuts" target="_blank" class="inline-link">Learn more about work requirements</a></p>

        <div class="radio-group" id="condition-options">
          <label class="radio-option" onclick="selectRadio(this, 'condition')">
            <input type="radio" name="condition" value="yes">
            <span class="radio-label">
              <span class="label-title">Yes</span>
              <span class="label-desc">I have a condition that limits my ability to work</span>
            </span>
          </label>
          <label class="radio-option" onclick="selectRadio(this, 'condition')">
            <input type="radio" name="condition" value="no">
            <span class="radio-label">
              <span class="label-title">No</span>
              <span class="label-desc">I do not have a limiting medical condition</span>
            </span>
          </label>
        </div>

        <button class="btn btn-primary" id="btn-next-1" disabled onclick="goToScreen(2)">Continue</button>
      </div>

      <!-- Screen 2: Doctor outreach consent -->
      <div class="screen" id="screen-2">
        <h2>Doctor Verification</h2>
        <p class="question">Would you like us to reach out to your doctor to verify your diagnosis?</p>

        <div class="radio-group" id="consent-options">
          <label class="radio-option" onclick="selectRadio(this, 'consent')">
            <input type="radio" name="consent" value="yes">
            <span class="radio-label">
              <span class="label-title">Yes, contact my doctor</span>
              <span class="label-desc">We'll send a short verification form to your doctor by email</span>
            </span>
          </label>
          <label class="radio-option" onclick="selectRadio(this, 'consent')">
            <input type="radio" name="consent" value="no">
            <span class="radio-label">
              <span class="label-title">No, I'll provide documentation myself</span>
              <span class="label-desc">You will need to submit medical documentation on your own</span>
            </span>
          </label>
        </div>

        <button class="btn btn-primary" id="btn-next-2" disabled onclick="goToScreen(3)">Continue</button>
        <button class="btn btn-secondary" onclick="goToScreen(1)">Back</button>
      </div>

      <!-- Screen 3: Doctor email input -->
      <div class="screen" id="screen-3">
        <h2>Doctor's Contact</h2>
        <p>Please provide your doctor's email address so we can send them the verification form.</p>

        <div class="form-group">
          <label for="doctor-email">Doctor's email address</label>
          <input type="email" id="doctor-email" placeholder="doctor@example.com" oninput="validateEmail()">
        </div>

        <div class="form-group">
          <label for="doctor-email-confirm">Confirm email address</label>
          <input type="email" id="doctor-email-confirm" placeholder="doctor@example.com" oninput="validateEmail()">
        </div>

        <button class="btn btn-primary" id="btn-submit" disabled onclick="goToScreen(4)">Submit</button>
        <button class="btn btn-secondary" onclick="goToScreen(2)">Back</button>
      </div>

      <!-- Screen 4: Next steps (doctor contact path) -->
      <div class="screen" id="screen-4">
        <h2>What Happens Next</h2>
        <p>We've received your information. Here's what to expect:</p>

        <ol class="steps-list">
          <li>
            <span class="step-number">1</span>
            <span class="step-text">We send a verification form to your doctor by email.</span>
          </li>
          <li>
            <span class="step-number">2</span>
            <span class="step-text">Your doctor has 10 business days to confirm your medical condition.</span>
          </li>
          <li>
            <span class="step-number">3</span>
            <span class="step-text">Once verified, your work requirement waiver is applied to your account.</span>
          </li>
          <li>
            <span class="step-number">4</span>
            <span class="step-text">You'll receive a notification confirming your updated Medicaid status.</span>
          </li>
        </ol>

        <p><a href="https://www.compass.dhs.pa.gov/" target="_blank" class="inline-link">Check your application status</a></p>

        <button class="btn btn-primary" onclick="window.location.href='index.html'">Done</button>
      </div>

      <!-- Screen: No medical condition -->
      <div class="screen" id="screen-no-condition">
        <h2>Work Requirement Applies</h2>
        <p>Based on your response, you do not qualify for a medical frailty waiver at this time.</p>
        <p>You are required to complete <strong>80 hours per month</strong> of qualifying activities, which include:</p>

        <ol class="steps-list">
          <li>
            <span class="step-number">1</span>
            <span class="step-text">Employment or self-employment</span>
          </li>
          <li>
            <span class="step-number">2</span>
            <span class="step-text">Job search or job training programs</span>
          </li>
          <li>
            <span class="step-number">3</span>
            <span class="step-text">Education or vocational coursework</span>
          </li>
          <li>
            <span class="step-number">4</span>
            <span class="step-text">Community service or volunteer work</span>
          </li>
        </ol>

        <p class="subtitle">If your circumstances change and you develop a medical condition that limits your ability to work, you can return here to request a waiver.</p>

        <p><a href="https://www.pa.gov/agencies/dhs/resources/federal-cuts" target="_blank" class="inline-link">Learn more about work requirements and exemptions</a></p>

        <button class="btn btn-primary" onclick="window.location.href='index.html'">Done</button>
        <button class="btn btn-secondary" onclick="goToScreen(1)">Back</button>
      </div>

      <!-- Screen: Self-submit documentation -->
      <div class="screen" id="screen-self-submit">
        <h2>Submit Your Own Documentation</h2>
        <p>You will need to provide medical documentation that supports your waiver request. Acceptable documents include:</p>

        <ol class="steps-list">
          <li>
            <span class="step-number">1</span>
            <span class="step-text">A signed letter from your doctor describing your condition and its impact on your ability to work</span>
          </li>
          <li>
            <span class="step-number">2</span>
            <span class="step-text">Medical records or a diagnosis summary</span>
          </li>
          <li>
            <span class="step-number">3</span>
            <span class="step-text">A completed Pennsylvania DHS <a href="https://www.pa.gov/content/dam/copapwp-pagov/en/dhs/documents/docs/documents/ma-response-forms/Medical%20Evaluation%20-%20Plan%20of%20Care.pdf" target="_blank" class="inline-link">Medical Frailty Certification Form (MA-51)</a></span>
          </li>
        </ol>

        <p>Submit documents by mail or upload them through your <a href="https://www.compass.dhs.pa.gov/" target="_blank" class="inline-link">Medicaid account portal</a>. Documentation must be received within <strong>30 days</strong>.</p>

        <button class="btn btn-primary" onclick="window.location.href='index.html'">Done</button>
        <button class="btn btn-secondary" onclick="goToScreen(2)">Back</button>
      </div>
    </div>
  </div>

  <script>
    function selectRadio(option, groupName) {
      // Clear selection styling in group
      const group = option.closest('.radio-group');
      group.querySelectorAll('.radio-option').forEach(o => o.classList.remove('selected'));
      option.classList.add('selected');
      option.querySelector('input[type="radio"]').checked = true;

      // Enable the continue button
      if (groupName === 'condition') {
        document.getElementById('btn-next-1').disabled = false;
      } else if (groupName === 'consent') {
        document.getElementById('btn-next-2').disabled = false;
      }
    }

    function validateEmail() {
      const email = document.getElementById('doctor-email').value;
      const confirm = document.getElementById('doctor-email-confirm').value;
      const btn = document.getElementById('btn-submit');

      const isValid = email.length > 0 && email.includes('@') && email === confirm;
      btn.disabled = !isValid;
    }

    function goToScreen(num) {
      // Branch on Screen 1: if "No" condition, go to no-condition screen
      if (num === 2) {
        const condition = document.querySelector('input[name="condition"]:checked');
        if (condition && condition.value === 'no') {
          showScreen('screen-no-condition', 4);
          return;
        }
      }

      // Branch on Screen 2: if "No" consent, go to self-submit screen
      if (num === 3) {
        const consent = document.querySelector('input[name="consent"]:checked');
        if (consent && consent.value === 'no') {
          showScreen('screen-self-submit', 3);
          return;
        }
      }

      showScreen('screen-' + num, num);
    }

    function showScreen(id, progressStep) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');

      document.querySelectorAll('.progress-dot').forEach((dot, i) => {
        dot.classList.toggle('active', i < progressStep);
      });
    }
  </script>
</body>
</html>
